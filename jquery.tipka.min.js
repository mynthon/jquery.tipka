!function(a){var b=function(){var b=this.options,c=this.content,d=this.holder,e=a(this.trigger),f=d.css("display"),g=parseInt(b.maxWidth),h=c.outerWidth()-c.width();c.children().each(function(){a(this).outerWidth()>g&&(g=a(this).outerWidth()+h)}),d.css({display:"block",width:"auto","max-width":g});var i="",j=0,k=0,l=0,m=0,n="t",o=a(window).height(),p=a(window).width(),q=a(window).scrollTop(),r=a(window).scrollLeft(),s=parseInt(e.offset().top),t=parseInt(e.offset().left),u=e.outerHeight(),v=e.outerWidth(),w=c.outerWidth(),x=c.outerHeight(),y=18,z=.25,A=b.edgeOffset,B=s-A-y-x,C=s+u/2-x*z,D=s+u/2-x*(1-z),E=s+u+A+y,F=s+u/2-x/2,G=t-A-y-w,H=t+v/2-w*(1-z),I=t+v/2-w*z,J=t+v+A+y,K=t+v/2-w/2,L=w*x,M=function(a,b){var c=Math.min(0,Math.max(-x,b-q)),d=Math.min(0,Math.max(-w,p-a-w)),e=Math.min(0,Math.max(-x,q+o-b-x)),f=Math.min(0,Math.max(-w,a-r));return 2*L-(L+(c+e)*x)-(L+(f+d)*w)},N={t:M(K,B),r:M(J,F),b:M(K,E),l:M(G,F),tr:M(I,B),rt:M(J,C),rb:M(J,D),br:M(I,E),bl:M(H,E),lb:M(G,D),lt:M(G,C),tl:M(H,B)};!function(){var d,a=1/0,c="",e=b.defaultPosition.split(",");if("defaults"===b.smartPosition){for(d in e)if(0===N[e[d]]){i=e[d];break}""===i&&(i=e[0])}else if("findAnySpot"===b.smartPosition){for(d in N)if(0===N[d]){i=d;break}""===i&&(i=e[0])}else if("defaultsBestFit"===b.smartPosition){for(d in e)N[e[d]]<a&&(a=N[e[d]],c=e[d]);i=c}else if("bestFit"===b.smartPosition){for(d in N)N[d]<a&&(a=N[d],c=d);i=c}""===i&&(i="t")}(),"t"==i?(j=s-A-y-x,k=t+v/2-w/2,l=x-1,m=w/2-y/2,n="t"):"r"==i?(j=s+u/2-x/2,k=t+v+A+y,l=x/2-y/2,m=0,n="r"):"b"==i?(j=s+u+A+y,k=t+v/2-w/2,l=-y+1,m=w/2-y/2,n="b"):"l"==i?(j=s+u/2-.5*x,k=t-A-y-w,l=x/2-y/2,m=w-1,n="l"):"tr"==i?(j=s-A-y-x,k=t+v/2-z*w,l=x-1,m=w*z-y/2,n="tr"):"rt"==i?(j=s+.5*u-z*x,k=t+v+A+y,l=x*z-y/2,m=0,n="rt"):"rb"==i?(j=s+u/2-(1-z)*x,k=t+v+A+y,l=x*(1-z)-y/2,m=0,n="rb"):"br"==i?(j=s+u+A+y,k=t+v/2-z*w,l=-y+1,m=w*z-y/2,n="br"):"bl"==i?(j=s+u+A+y,k=t+v/2-(1-z)*w,l=-y+1,m=w*(1-z)-y/2,n="bl"):"lb"==i?(j=s+u/2-(1-z)*x,k=t-A-y-w,l=x*(1-z)-y/2,m=w-1,n="lb"):"lt"==i?(j=s+u/2-z*x,k=t-A-y-w,l=x*z-y/2,m=w-1,n="lt"):"tl"==i&&(j=s-A-y-x,k=t+v/2-(1-z)*w,l=x-1,m=w*(1-z)-y/2,n="tl");var O=d.width();d.css({width:O,"margin-top":j,"margin-left":k,display:f}).removeClass(d.attr("data-tipkaclass")).addClass("tip_"+n).attr("data-tipkaclass","tip_"+n),this.arrow.css({"margin-left":m,"margin-top":l})};a.tipkaTipDefaults={addClass:"",activation:"hover",keepAlive:!1,maxWidth:"200px",maxHeight:null,edgeOffset:3,defaultPosition:"b",smartPosition:"defaultsBestFit",keepOnTip:!0,delay:400,fadeIn:200,fadeOut:50,attribute:"title",content:!1,enter:function(){},exit:function(){}};var c=function(a,b){this.id="tiphld"+ +new Date+Math.round(1e6*Math.random()),this.idSel="."+this.id,this.trigger=a,this.holder=null,this.content=null,this.arrow=null,this.options=b,this.cloto,this.clotms=200,this.init()};c.prototype={init:function(){var b=this.options;a(".tipka_holder"+this.idSel).length>0&&this.holder.stop().remove(),this.holder=a('<div class="tipka_holder '+this.id+" "+b.addClass+'" style="min-width:40px; position:absolute; top:0; left:0; display:block; margin-left:-9999em;max-width:'+b.maxWidth+';"></div>'),this.content=a('<div class="tipka_content"></div>'),this.arrow=a('<div class="tipka_arrow" style="position:absolute;"><div class="tipka_arrow_outer"></div><div class="tipka_arrow_inner"></div></div>'),this.holder.attr("data-tipkaclass","").append(this.content).prepend(this.arrow),b.maxHeight&&this.content.css({maxHeight:b.maxHeight,overflow:"auto"})},open:function(){var a=this.isAttached(),c=this.options;clearTimeout(this.cloto),a||(this.attach(),b.call(this),this.holder.hide(),this.holder.css({opacity:0}));var d=(1-parseFloat(this.holder.css("opacity")||0))*c.fadeIn;this.holder.stop(!0,!1).fadeTo(d,1)},close:function(){var a=this,b=this.options,c=this.holder;this.cloto=setTimeout(function(){c.stop(!0,!1).fadeTo(b.fadeOut,0,function(){a.detach(),c.css({display:"block",marginLeft:"-9999em"})})},this.clotms)},hideByMargin:function(){this.holder.css({"margin-top":"-999999em","margin-left":"-999999em"})},attach:function(){var b=this,c=this.holder,d=this.isAttached();d||(a("body").append(c),this.options.keepOnTip&&(c.off("mouseover.tipka").on("mouseover.tipka",function(){b.open()}),c.off("mouseout.tipka").on("mouseout.tipka",function(){b.close()})))},detach:function(){a(this.idSel).remove()},isAttached:function(){return a(this.idSel).length>0},setContent:function(c){var d=this,e=a("<div />").html(c);e.find("img").hide(),this.content.html(e.html());var f=this.content.find("img");f.each(function(){var c=a(this),e=new Image;e.onload=function(){d.hideByMargin(),c.show(),b.call(d)},e.onerror=function(){d.hideByMargin(),c.show(),b.call(d)},e.src=a(this).attr("src")})}};var d={init:function(d){var e=d;return this.each(function(){function l(){d.data("tipPanel")||(d.data("tipPanel",new c(f,f.opts)),k=d.data("tipPanel"))}function m(){var a=i.content,b=i.attribute,c="";return"string"==typeof a?c=a:"function"==typeof a?c=a(d):a instanceof jQuery?c=a.html():b&&(c=d.attr(b)),c}var d=a(this),f=this,g=null;if(d.hasClass(".tipka_hastip"))return!0;var h={};a.extend(h,a.tipkaTipDefaults,e),this.opts=h;var i=f.opts;d.addClass("tipka_hastip");var j="",k=null;this.updateContent=function(a){console.log("BACKWARD COMPATIBILITY: updateContent"),k.setContent(a),b.call(k)};var n=function(a){a.preventDefault(),a.stopPropagation(),g=setTimeout(function(){f.open()},k&&k.isAttached()?0:i.delay)};this.open=function(){l(),k.setContent(m()),j=d.attr("title"),d.attr("title",null),k.open()};var o=function(){clearTimeout(g),k&&!i.keepAlive&&k.close(),j&&d.attr("title",j)};this.close=function(){k&&k.close(),j&&d.attr("title",j)},"elsewhere"===i.activation||("click"===i.activation?(d.on("click",function(a){n(a)}),d.on("mouseout",function(){o()})):"hover"===i.activation?(d.on("mouseover",function(a){n(a)}),d.on("mouseout",function(){o()})):"focus"===i.activation&&(d.on("focus",function(a){n(a)}),d.on("blur",function(){o()})))})},show:function(){return this.each(function(){console.log("deprecated show(), use open() instead"),this.open()})},hide:function(){return this.each(function(){console.log("deprecated hide(), use close() instead"),this.close()})},open:function(){return this.each(function(){this.open()})},close:function(){return this.each(function(){this.close()})},updateContent:function(c){return this.each(function(){var d=a(this).data("tipPanel");d.setContent(c),b.call(d)})}};a.fn.tipka=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.tipka"),void 0):d.init.apply(this,arguments)}}(jQuery);